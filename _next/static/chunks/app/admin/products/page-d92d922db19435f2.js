(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{989:function(e,t,s){Promise.resolve().then(s.bind(s,7796))},7796:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var l=s(9073),a=s(3794),r=s(3963),i=s.n(r),n=s(1533),d=s(4600),c=s(424),o=s(619),m=s(7065),x=s(9619),g=s(4201);let u=(0,m.eI)(x.NF,x.QK);function h(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(1),[m,x]=(0,a.useState)(0),[h,f]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(""),[C,E]=(0,a.useState)("less"),[I,S]=(0,a.useState)(!1),[Z,O]=(0,a.useState)(null),[R,_]=(0,a.useState)(""),M=Math.ceil(m/10),J=async(e,s)=>{v(!0);try{let l=u.from("products").select("*",{count:"exact"});s&&(l=l.ilike("code","%".concat(s,"%"))),w&&!isNaN(Number(w))&&(l="greater"===C?l.gte("stock",Number(w)):l.lte("stock",Number(w)));let{data:a,count:r,error:i}=await l.range((e-1)*10,10*e-1).order("created_at",{ascending:!1});if(i)throw i;t(a||[]),x(r||0)}catch(e){console.error("Error fetching products:",e)}finally{v(!1)}};(0,a.useEffect)(()=>{J(s,p)},[s,p,w,C]);let z=e=>{e>=1&&e<=M&&r(e)},A=async()=>{if(Z&&R)try{let{error:s}=await u.from("products").update({stock:Number(R)}).eq("id",Z.id);if(s)throw s;t(e.map(e=>e.id===Z.id?{...e,stock:Number(R)}:e)),S(!1)}catch(e){console.error("Error updating stock:",e)}},F=e=>{O(e),_(e.stock.toString()),S(!0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i(),{children:(0,l.jsx)("title",{children:"مدیریت محصولات | فروشگاه رضائی"})}),(0,l.jsxs)("div",{className:"py-2",children:[(0,l.jsx)("header",{}),(0,l.jsx)("main",{children:(0,l.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center",children:[(0,l.jsxs)("div",{className:"flex-auto",children:[(0,l.jsx)("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"لیست محصولات"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-gray-700",children:"لیست محصولات تعریف شده در سیستم."})]}),(0,l.jsxs)("div",{className:"mt-4 flex gap-2 sm:mt-0",children:[(0,l.jsx)(n.default,{href:"/admin/products/add",type:"button",className:"block w-full rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"افزودن محصول جدید"}),(0,l.jsxs)("button",{type:"button",className:"flex items-center rounded-md bg-gray-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-gray-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600",onClick:()=>N(e=>!e),children:[(0,l.jsx)(d.Z,{className:"h-5 w-5 ml-1","aria-hidden":"true"}),"فیلتر"]})]})]}),j&&(0,l.jsxs)("div",{className:"my-8 flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsx)("input",{type:"text",value:h,onChange:e=>f(e.target.value),placeholder:"جستجو بر اساس کد محصول",className:"block w-full rounded-md border-0 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,l.jsxs)("div",{className:"flex gap-2 sm:gap-4",children:[(0,l.jsx)("button",{onClick:()=>{r(1),y(h)},className:"flex-1 rounded-md bg-green-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-400",children:"جستجو"}),(0,l.jsx)("button",{onClick:()=>{f(""),y(""),r(1),J(1,"")},className:"flex-1 rounded-md bg-gray-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-500",children:"ریست"})]})]}),(0,l.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,l.jsxs)("div",{className:"flex-1 flex flex-col sm:flex-row gap-4",children:[(0,l.jsxs)("select",{value:C,onChange:e=>E(e.target.value),className:"block w-full rounded-md border-0 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[(0,l.jsx)("option",{value:"less",children:"موجودی کمتر از"}),(0,l.jsx)("option",{value:"greater",children:"موجودی بیشتر از"})]}),(0,l.jsx)("input",{type:"number",value:w,onChange:e=>k(e.target.value),placeholder:"تعداد موجودی",className:"block w-full rounded-md border-0 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,l.jsx)("div",{className:"flex gap-2 sm:gap-4",children:(0,l.jsx)("button",{onClick:()=>{k(""),E("greater"),r(1)},className:"flex-1 rounded-md bg-gray-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-500",children:"ریست"})})]})})]}),(0,l.jsx)("div",{className:"-mx-4 mt-16 sm:-mx-0",children:b?(0,l.jsx)("div",{className:"text-center py-4",children:"در حال بارگذاری..."}):(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-right text-sm font-semibold text-gray-900 sm:pl-0",children:"نام محصول"}),(0,l.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900",children:"کد"}),(0,l.jsx)("th",{scope:"col",className:"hidden px-3 py-3.5 text-right text-sm font-semibold text-gray-900 lg:table-cell",children:"جنس ورق"}),(0,l.jsx)("th",{scope:"col",className:"hidden px-3 py-3.5 text-right text-sm font-semibold text-gray-900 lg:table-cell",children:"موجودی انبار"}),(0,l.jsx)("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-0",children:(0,l.jsx)("span",{className:"sr-only",children:"ویرایش"})})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{className:"w-full max-w-0 py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:w-auto sm:max-w-none sm:pl-0",children:[e.name,(0,l.jsxs)("dl",{className:"font-normal lg:hidden pt-2",children:[(0,l.jsx)("dt",{className:"text-gray-700 font-bold sr-only",children:"جنس ورق"}),(0,l.jsx)("dd",{className:"mt-1 truncate text-gray-500",children:e.category||"جنس ورق تعیین نشده"}),(0,l.jsx)("dt",{className:"text-gray-700 font-bold sr-only",children:"موجودی انبار"}),(0,l.jsxs)("dd",{className:"mt-1 truncate text-gray-500",children:[e.stock," عدد موجود"]})]})]}),(0,l.jsx)("td",{className:"px-3 py-4 text-sm text-gray-500",children:e.code}),(0,l.jsx)("td",{className:"hidden px-3 py-4 text-sm text-gray-500 lg:table-cell",children:e.category||"تعیین نشده"}),(0,l.jsx)("td",{className:"hidden px-3 py-4 text-sm text-gray-500 lg:table-cell",children:e.stock}),(0,l.jsx)("td",{className:"py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0",children:(0,l.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,l.jsx)(n.default,{href:"/admin/products/edit?id=".concat(e.id),className:"text-indigo-600 hover:text-indigo-900",children:"ویرایش"}),(0,l.jsx)("span",{className:"text-gray-300",children:"|"}),(0,l.jsx)("button",{onClick:()=>F(e),className:"text-indigo-600 hover:text-indigo-900  whitespace-nowrap",children:"تغییر موجودی"})]})})]},e.id))})]})})]}),(0,l.jsxs)("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 mt-16",children:[(0,l.jsx)("div",{className:"-mt-px flex w-0 flex-1",children:(0,l.jsxs)("button",{onClick:()=>z(s+1),disabled:s===M,className:"inline-flex items-center border-t-2 border-transparent pr-1 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700 disabled:opacity-50",children:[(0,l.jsx)(c.Z,{className:"ml-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),"صفحه بعد"]})}),(0,l.jsx)("div",{className:"hidden md:-mt-px md:flex",children:Array.from({length:M},(e,t)=>t+1).map(e=>(0,l.jsx)("button",{onClick:()=>z(e),className:"inline-flex items-center border-t-2 px-4 pt-4 text-sm font-medium ".concat(s===e?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:e},e))}),(0,l.jsx)("div",{className:"-mt-px flex w-0 flex-1 justify-end",children:(0,l.jsxs)("button",{onClick:()=>z(s-1),disabled:1===s,className:"inline-flex items-center border-t-2 border-transparent pl-1 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700 disabled:opacity-50",children:["صفحه قبل",(0,l.jsx)(o.Z,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"})]})})]})]})})]}),Z&&(0,l.jsxs)(g.Vq,{open:I,onClose:()=>S(!1),className:"relative z-10",children:[(0,l.jsx)(g.ZR,{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsxs)(g.EM,{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,l.jsx)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,l.jsx)("div",{className:"sm:flex sm:items-start",children:(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,l.jsxs)(g.$N,{as:"h3",className:"text-base font-semibold text-gray-900",children:["بروزرسانی موجودی ",Z.name]}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("input",{type:"number",value:R,onChange:e=>_(e.target.value),className:"block w-full rounded-md border-0 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,l.jsx)("button",{type:"button",onClick:A,className:"inline-flex w-full justify-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 sm:ml-3 sm:w-auto",children:"ذخیره"}),(0,l.jsx)("button",{type:"button",onClick:()=>S(!1),className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:ml-3",children:"انصراف"})]})]})})})]})]})}},9619:function(e,t,s){"use strict";s.d(t,{NF:function(){return l},QK:function(){return a}}),s(677).env.NEXT_PUBLIC_SHOW_LOGGER;let l="https://aqcfdwrgshzjnadidamy.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxY2Zkd3Jnc2h6am5hZGlkYW15Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzAwNDI2MTgsImV4cCI6MjA0NTYxODYxOH0.mZHOBtLvEFGRU25Cx_wR3dkv0OH2SrV6CfqkCe9G5UU"},619:function(e,t,s){"use strict";var l=s(3794);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...r}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),s?l.createElement("title",{id:a},s):null,l.createElement("path",{fillRule:"evenodd",d:"M18 10a.75.75 0 0 1-.75.75H4.66l2.1 1.95a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 1 1 1.02 1.1l-2.1 1.95h12.59A.75.75 0 0 1 18 10Z",clipRule:"evenodd"}))});t.Z=a},424:function(e,t,s){"use strict";var l=s(3794);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...r}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),s?l.createElement("title",{id:a},s):null,l.createElement("path",{fillRule:"evenodd",d:"M2 10a.75.75 0 0 1 .75-.75h12.59l-2.1-1.95a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.1-1.95H2.75A.75.75 0 0 1 2 10Z",clipRule:"evenodd"}))});t.Z=a},4600:function(e,t,s){"use strict";var l=s(3794);let a=l.forwardRef(function(e,t){let{title:s,titleId:a,...r}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),s?l.createElement("title",{id:a},s):null,l.createElement("path",{fillRule:"evenodd",d:"M2.628 1.601C5.028 1.206 7.49 1 10 1s4.973.206 7.372.601a.75.75 0 0 1 .628.74v2.288a2.25 2.25 0 0 1-.659 1.59l-4.682 4.683a2.25 2.25 0 0 0-.659 1.59v3.037c0 .684-.31 1.33-.844 1.757l-1.937 1.55A.75.75 0 0 1 8 18.25v-5.757a2.25 2.25 0 0 0-.659-1.591L2.659 6.22A2.25 2.25 0 0 1 2 4.629V2.34a.75.75 0 0 1 .628-.74Z",clipRule:"evenodd"}))});t.Z=a}},function(e){e.O(0,[547,533,55,8,355,102,744],function(){return e(e.s=989)}),_N_E=e.O()}]);